<!DOCTYPE html>
<html>

<head>
  <title>HowManySwimmers Running Check</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      max-width: 600px;
      margin: 40px auto;
      padding: 0 20px;
      line-height: 1.6;
    }

    .button {
      display: inline-block;
      padding: 10px 20px;
      background: #0066cc;
      color: white;
      text-decoration: none;
      border-radius: 4px;
      margin-top: 20px;
    }

    .button:hover {
      background: #0052a3;
    }

    .warning {
      padding: 15px;
      background: #fff3cd;
      border: 1px solid #ffeeba;
      border-radius: 4px;
      color: #856404;
      margin: 20px 0;
    }

    #status {
      margin: 20px 0;
    }
  </style>
</head>

<body>
  <h1>HowManySwimmers Availability Check</h1>
  <div>
    <p>
      HowManySwimmers is a web app that counts Salties swimmers. HowManySwimmers does face recognition. The process has
      intense computational requirements and it would be expensive to host on the Internet, think US$100+ per month.
    </p>
    <p>
      So it's hosted on Chris Adams' laptop. But that means it might not be working right now! Eg. Chris is out of the
      house, or his laptop is off, or his internet is down.
    </p>
    <p>
      So here is a page that will check for you if it's running, and then let you visit the site. If it's not
      running, you can still try to visit, but you might have issues.
    </p>
    <p>
      Of course if you do have issues, you're invited to contact Chris Adams on Whatsapp.
    </p>
  </div>
  <div id="status">Checking if HowManySwimmers is up and running...</div>
  <div id="content"></div>

  <script>
    const targetUrl = 'https://macbookpro.myth-minor.ts.net';

    async function checkWebsite() {
      contentDiv.innerHTML = `
          <a href="${targetUrl}" target="_blank" rel="noopener noreferrer" class="button">
              Visit HowManySwimmers (the check is still running...) ↗
          </a>
      `;

      const statusDiv = document.getElementById('status');
      const contentDiv = document.getElementById('content');

      try {
        const response = await fetch(targetUrl, { mode: 'no-cors' });
        // Site appears to be up
        statusDiv.textContent = 'The website appears to be up and running!';
        contentDiv.innerHTML = `
                    <a href="${targetUrl}" target="_blank" rel="noopener noreferrer" class="button">
                        Visit HowManySwimmers (it's working!) ↗
                    </a>
                `;
      } catch (error) {
        // Site might be down
        statusDiv.textContent = '';
        contentDiv.innerHTML = `
                    <div class="warning">
                        The website appears to be down at the moment. You can still try visiting it, 
                        but you may encounter issues. If problems persist, please contact Chris Adams on Whatsapp.
                    </div>
                    <a href="${targetUrl}" target="_blank" rel="noopener noreferrer" class="button">
                        Try Visiting HowManySwimmers Anyway ↗
                    </a>
                    <p><small>Contact Chris on Whatsapp to ask him to fix his laptop!</small></p>
                `;
      }
    }

    // Run the check when page loads
    checkWebsite();
  </script>
</body>

</html>